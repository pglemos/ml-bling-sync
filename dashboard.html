<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML + Bling Sync - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Base URL para API hospedada no Vercel -->
    <script>
        const API_BASE_URL = "https://ml-bling-sync.vercel.app";
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .gradient-success { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .gradient-warning { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        .gradient-secondary { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .card-premium { background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%); border: 1px solid rgba(226, 232, 240, 0.8); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); transition: all 0.3s; }
        .card-premium:hover { transform: translateY(-4px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .sidebar-item { transition: all 0.3s; border-radius: 12px; margin: 2px 0; }
        .sidebar-item:hover { background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.05) 100%); transform: translateX(4px); }
        .sidebar-item.active { background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; }
        .page-content { display: none; }
        .page-content.active { display: block; animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Spinner de Carregamento -->
    <div id="loading-spinner" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 hidden">
        <div class="w-16 h-16 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin"></div>
    </div>
    
    <!-- Toast de Notificação -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 flex flex-col space-y-4 max-w-xs w-full hidden">
        <div id="toast" class="bg-white rounded-xl shadow-lg overflow-hidden transform transition-all duration-300 opacity-0 translate-y-4">
            <div class="p-4 flex items-start">
                <div id="toast-icon" class="flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center mr-3">
                    <i id="toast-icon-svg" data-lucide="check" class="w-5 h-5"></i>
                </div>
                <div class="flex-1 pt-0.5">
                    <h3 id="toast-title" class="text-sm font-medium text-gray-900">Sucesso</h3>
                    <p id="toast-message" class="mt-1 text-sm text-gray-500">Operação realizada com sucesso!</p>
                </div>
                <button onclick="hideToast()" class="ml-4 text-gray-400 hover:text-gray-600">
                    <i data-lucide="x" class="w-4 h-4"></i>
                </button>
            </div>
            <div id="toast-progress" class="h-1 bg-indigo-600 w-full transform origin-left scale-x-0 transition-transform duration-300"></div>
        </div>
    </div>
    <!-- Sidebar -->
    <div class="fixed inset-y-0 left-0 z-50 w-72 bg-white shadow-2xl border-r border-gray-100">
        <div class="flex flex-col h-full">
            <!-- Logo -->
            <div class="flex items-center justify-center h-20 px-6 border-b border-gray-100">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 gradient-primary rounded-xl flex items-center justify-center shadow-lg">
                        <i data-lucide="zap" class="w-6 h-6 text-white"></i>
                    </div>
                    <div>
                        <span class="text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">SyncPro</span>
                        <p class="text-xs text-gray-500 font-medium">ML ↔ Bling Integration</p>
                    </div>
                </div>
            </div>
            
            <!-- Navigation -->
            <nav class="flex-1 px-4 py-8 space-y-2">
                <a href="#" class="sidebar-item active flex items-center px-4 py-3 text-sm font-semibold rounded-xl" data-page="dashboard">
                    <i data-lucide="layout-dashboard" class="w-5 h-5 mr-4"></i>
                    Dashboard
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-sm font-medium text-gray-600 rounded-xl" data-page="integrations">
                    <i data-lucide="plug" class="w-5 h-5 mr-4"></i>
                    Integrações
                    <span class="ml-auto bg-indigo-100 text-indigo-600 text-xs px-2 py-1 rounded-full">2</span>
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-sm font-medium text-gray-600 rounded-xl" data-page="products">
                    <i data-lucide="package" class="w-5 h-5 mr-4"></i>
                    Produtos
                    <span class="ml-auto bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full" id="products-count">3</span>
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-sm font-medium text-gray-600 rounded-xl" data-page="sync">
                    <i data-lucide="refresh-cw" class="w-5 h-5 mr-4"></i>
                    Sincronização
                </a>
                <a href="#" class="sidebar-item flex items-center px-4 py-3 text-sm font-medium text-gray-600 rounded-xl" data-page="logs">
                    <i data-lucide="file-text" class="w-5 h-5 mr-4"></i>
                    Logs
                </a>
            </nav>
            
            <!-- User Profile -->
            <div class="p-6 border-t border-gray-100">
                <div class="flex items-center space-x-3 p-3 rounded-xl bg-gray-50">
                    <div class="w-12 h-12 gradient-primary rounded-xl flex items-center justify-center shadow-lg">
                        <span class="text-white font-bold text-sm">JS</span>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-semibold text-gray-900">João Silva</p>
                        <p class="text-xs text-gray-500">Plano Premium</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="ml-72">
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page-content active">
            <!-- Header -->
            <header class="bg-white border-b border-gray-100 sticky top-0 z-40">
                <div class="px-8 py-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Dashboard</h1>
                            <p class="text-gray-600 mt-1 font-medium">Visão geral da sincronização ML ↔ Bling</p>
                        </div>
                        <div class="flex items-center space-x-4">
                            <button onclick="runSync()" class="bg-indigo-600 text-white px-6 py-3 rounded-xl font-semibold flex items-center space-x-2 hover:bg-indigo-700 transition-colors">
                                <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                                <span>Sincronizar Agora</span>
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Dashboard Content -->
            <main class="p-8">
                <!-- Metrics Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="card-premium p-6 rounded-2xl">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-12 h-12 gradient-success rounded-xl flex items-center justify-center shadow-lg">
                                <i data-lucide="trending-up" class="w-6 h-6 text-white"></i>
                            </div>
                            <span class="text-xs font-semibold text-green-600 bg-green-50 px-2 py-1 rounded-full">+12.5%</span>
                        </div>
                        <h3 class="text-sm font-semibold text-gray-600 uppercase tracking-wide">Produtos Sincronizados</h3>
                        <p class="text-3xl font-bold text-gray-900 mt-2" id="sync-count">856</p>
                        <p class="text-sm text-gray-500 mt-2">vs. 760 ontem</p>
                    </div>

                    <div class="card-premium p-6 rounded-2xl">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-12 h-12 gradient-primary rounded-xl flex items-center justify-center shadow-lg">
                                <i data-lucide="shopping-bag" class="w-6 h-6 text-white"></i>
                            </div>
                            <span class="text-xs font-semibold text-blue-600 bg-blue-50 px-2 py-1 rounded-full">Ativo</span>
                        </div>
                        <h3 class="text-sm font-semibold text-gray-600 uppercase tracking-wide">Integrações</h3>
                        <p class="text-3xl font-bold text-gray-900 mt-2">2</p>
                        <p class="text-sm text-gray-500 mt-2">ML + Bling conectados</p>
                    </div>

                    <div class="card-premium p-6 rounded-2xl">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-12 h-12 gradient-warning rounded-xl flex items-center justify-center shadow-lg">
                                <i data-lucide="package" class="w-6 h-6 text-white"></i>
                            </div>
                            <span class="text-xs font-semibold text-purple-600 bg-purple-50 px-2 py-1 rounded-full">Pendentes</span>
                        </div>
                        <h3 class="text-sm font-semibold text-gray-600 uppercase tracking-wide">Produtos Pendentes</h3>
                        <p class="text-3xl font-bold text-gray-900 mt-2" id="pending-count">0</p>
                        <p class="text-sm text-gray-500 mt-2">Aguardando sincronização</p>
                    </div>

                    <div class="card-premium p-6 rounded-2xl">
                        <div class="flex items-center justify-between mb-4">
                            <div class="w-12 h-12 gradient-secondary rounded-xl flex items-center justify-center shadow-lg">
                                <i data-lucide="clock" class="w-6 h-6 text-white"></i>
                            </div>
                            <span class="text-xs font-semibold text-orange-600 bg-orange-50 px-2 py-1 rounded-full">Última</span>
                        </div>
                        <h3 class="text-sm font-semibold text-gray-600 uppercase tracking-wide">Última Sincronização</h3>
                        <p class="text-3xl font-bold text-gray-900 mt-2" id="last-sync">2min</p>
                        <p class="text-sm text-gray-500 mt-2">atrás</p>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div class="card-premium p-8 rounded-2xl">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">Ações Rápidas</h3>
                        <div class="space-y-4">
                            <button onclick="runSync()" class="w-full flex items-center p-4 text-left bg-gradient-to-r from-green-50 to-emerald-50 hover:from-green-100 hover:to-emerald-100 rounded-xl transition-all duration-300 border border-green-100 hover:border-green-200">
                                <div class="w-12 h-12 gradient-success rounded-xl flex items-center justify-center mr-4 shadow-lg">
                                    <i data-lucide="refresh-cw" class="w-6 h-6 text-white"></i>
                                </div>
                                <div>
                                    <p class="font-semibold text-gray-900">Sincronizar Produtos</p>
                                    <p class="text-sm text-gray-600">ML ↔ Bling automático</p>
                                </div>
                                <i data-lucide="arrow-right" class="w-5 h-5 text-gray-400 ml-auto"></i>
                            </button>
                            
                            <button onclick="addTestProducts()" class="w-full flex items-center p-4 text-left bg-gradient-to-r from-blue-50 to-indigo-50 hover:from-blue-100 hover:to-indigo-100 rounded-xl transition-all duration-300 border border-blue-100 hover:border-blue-200">
                                <div class="w-12 h-12 gradient-primary rounded-xl flex items-center justify-center mr-4 shadow-lg">
                                    <i data-lucide="plus" class="w-6 h-6 text-white"></i>
                                </div>
                                <div>
                                    <p class="font-semibold text-gray-900">Adicionar Produtos Teste</p>
                                    <p class="text-sm text-gray-600">Criar produtos para demonstração</p>
                                </div>
                                <i data-lucide="arrow-right" class="w-5 h-5 text-gray-400 ml-auto"></i>
                            </button>
                            
                            <button onclick="checkIntegrations()" class="w-full flex items-center p-4 text-left bg-gradient-to-r from-purple-50 to-pink-50 hover:from-purple-100 hover:to-pink-100 rounded-xl transition-all duration-300 border border-purple-100 hover:border-purple-200">
                                <div class="w-12 h-12 gradient-secondary rounded-xl flex items-center justify-center mr-4 shadow-lg">
                                    <i data-lucide="check-circle" class="w-6 h-6 text-white"></i>
                                </div>
                                <div>
                                    <p class="font-semibold text-gray-900">Verificar Integrações</p>
                                    <p class="text-sm text-gray-600">Status das conexões</p>
                                </div>
                                <i data-lucide="arrow-right" class="w-5 h-5 text-gray-400 ml-auto"></i>
                            </button>
                        </div>
                    </div>

                    <div class="card-premium p-8 rounded-2xl">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">Status das Integrações</h3>
                        <div class="space-y-6">
                            <div class="flex items-center justify-between p-4 bg-green-50 rounded-xl border border-green-200">
                                <div class="flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-yellow-400 rounded-lg flex items-center justify-center">
                                        <span class="text-white font-bold text-xs">ML</span>
                                    </div>
                                    <div>
                                        <span class="font-medium text-gray-900">Mercado Livre</span>
                                        <p class="text-sm text-gray-600">Token válido</p>
                                    </div>
                                </div>
                                <span class="text-green-600 font-semibold">✓ Conectado</span>
                            </div>
                            <div class="flex items-center justify-between p-4 bg-green-50 rounded-xl border border-green-200">
                                <div class="flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                                        <span class="text-white font-bold text-xs">B</span>
                                    </div>
                                    <div>
                                        <span class="font-medium text-gray-900">Bling ERP</span>
                                        <p class="text-sm text-gray-600">Token válido</p>
                                    </div>
                                </div>
                                <span class="text-green-600 font-semibold">✓ Conectado</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card-premium rounded-2xl overflow-hidden">
                    <div class="px-8 py-6 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white">
                        <h3 class="text-xl font-bold text-gray-900">Atividade Recente</h3>
                        <p class="text-gray-500 mt-1">Últimas sincronizações e operações</p>
                    </div>
                    <div class="p-8">
                        <div id="activity-log" class="space-y-4">
                            <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-xl">
                                <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                    <i data-lucide="check" class="w-5 h-5 text-green-600"></i>
                                </div>
                                <div class="flex-1">
                                    <p class="font-medium text-gray-900">Sincronização iniciada</p>
                                    <p class="text-sm text-gray-500">Produtos sincronizados com sucesso</p>
                                </div>
                                <span class="text-sm text-gray-400">2 min atrás</span>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Products Page -->
        <div id="products-page" class="page-content">
            <header class="bg-white border-b border-gray-100 sticky top-0 z-40">
                <div class="px-8 py-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Produtos</h1>
                            <p class="text-gray-600 mt-1 font-medium">Gerencie seu catálogo de produtos</p>
                        </div>
                        <button onclick="addTestProducts()" class="bg-indigo-600 text-white px-6 py-3 rounded-xl font-semibold flex items-center space-x-2 hover:bg-indigo-700 transition-colors">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            <span>Adicionar Produtos Teste</span>
                        </button>
                    </div>
                </div>
            </header>

            <main class="p-8">
                <div class="card-premium rounded-2xl overflow-hidden">
                    <div class="px-8 py-6 border-b border-gray-100">
                        <div class="flex flex-col md:flex-row md:items-center justify-between space-y-4 md:space-y-0">
                            <h3 class="text-xl font-bold text-gray-900">Catálogo de Produtos</h3>
                            <div class="flex flex-col md:flex-row items-start md:items-center space-y-3 md:space-y-0 md:space-x-3">
                                <div class="relative w-full md:w-64">
                                    <input type="text" id="product-search" placeholder="Buscar produtos..." class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                    <i data-lucide="search" class="w-4 h-4 text-gray-400 absolute right-3 top-3"></i>
                                </div>
                                <select id="status-filter" class="px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                    <option value="all">Todos os status</option>
                                    <option value="active">Em Estoque</option>
                                    <option value="inactive">Indisponível</option>
                                </select>
                                <button id="clear-filters-btn" class="px-4 py-2 border border-gray-200 rounded-lg text-gray-700 font-medium hover:bg-gray-100 transition-colors flex items-center space-x-2">
                                    <i data-lucide="x" class="w-4 h-4"></i>
                                    <span>Limpar Filtros</span>
                                </button>
                                <button id="add-product-btn" class="bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold flex items-center space-x-2 hover:bg-indigo-700 transition-colors">
                                    <i data-lucide="plus" class="w-4 h-4"></i>
                                    <span>Novo Produto</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="p-8">
                        <div id="products-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                            <!-- Products will be loaded here -->
                        </div>
                        <div id="no-products" class="hidden text-center py-12">
                            <div class="w-20 h-20 mx-auto bg-gray-100 rounded-full flex items-center justify-center mb-4">
                                <i data-lucide="package-x" class="w-10 h-10 text-gray-400"></i>
                            </div>
                            <h4 class="text-lg font-semibold text-gray-900 mb-2">Nenhum produto encontrado</h4>
                            <p class="text-gray-500">Tente ajustar os filtros ou adicionar novos produtos</p>
                        </div>
                    </div>
                </div>
            </main>
            
            <!-- Modal de Produto -->
            <div id="product-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 hidden">
                <div class="bg-white rounded-2xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                    <div class="px-8 py-6 border-b border-gray-100 sticky top-0 bg-white z-10">
                        <div class="flex items-center justify-between">
                            <h3 class="text-xl font-bold text-gray-900" id="modal-title">Adicionar Novo Produto</h3>
                            <button onclick="closeProductModal()" class="text-gray-400 hover:text-gray-600">
                                <i data-lucide="x" class="w-6 h-6"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-8">
                        <!-- Steps Indicator -->
                        <div class="flex items-center justify-between mb-8">
                            <div class="flex-1">
                                <div class="relative">
                                    <!-- Barra de progresso com gradiente e sombra -->
                                    <div class="h-2 bg-gray-200 rounded-full shadow-inner">
                                        <div id="steps-progress" class="h-2 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full w-0 transition-all duration-500 shadow-lg"></div>
                                    </div>
                                    <!-- Indicadores de passos com efeitos visuais aprimorados -->
                                    <div class="flex items-center justify-between mt-3 relative">
                                        <!-- Linhas conectoras entre os passos -->
                                        <div class="absolute top-4 left-0 right-0 h-0.5 bg-gray-200 -z-10"></div>
                                        
                                        <!-- Passo 1 -->
                                        <div class="step-indicator active" data-step="1">
                                            <div class="w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-indigo-700 text-white flex items-center justify-center font-semibold text-sm shadow-md transform transition-all duration-300 border-2 border-white">
                                                <i data-lucide="clipboard-list" class="w-5 h-5"></i>
                                            </div>
                                            <span class="text-xs font-medium mt-2 block text-center text-indigo-700">Informações</span>
                                        </div>
                                        
                                        <!-- Passo 2 -->
                                        <div class="step-indicator" data-step="2">
                                            <div class="w-10 h-10 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-semibold text-sm shadow-sm transform transition-all duration-300 border-2 border-white">
                                                <i data-lucide="layers" class="w-5 h-5"></i>
                                            </div>
                                            <span class="text-xs font-medium mt-2 block text-center text-gray-500">Plataformas</span>
                                        </div>
                                        
                                        <!-- Passo 3 -->
                                        <div class="step-indicator" data-step="3">
                                            <div class="w-10 h-10 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-semibold text-sm shadow-sm transform transition-all duration-300 border-2 border-white">
                                                <i data-lucide="check-circle" class="w-5 h-5"></i>
                                            </div>
                                            <span class="text-xs font-medium mt-2 block text-center text-gray-500">Revisão</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Step 1: Informações Básicas -->
                        <div id="step-1" class="step-content">
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Nome do Produto</label>
                                    <input type="text" id="product-name" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Descrição</label>
                                    <textarea id="product-description" rows="3" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"></textarea>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Preço (R$)</label>
                                        <input type="number" id="product-price" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                                        <select id="product-status" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                            <option value="active">Em Estoque</option>
                                            <option value="inactive">Indisponível</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-8 flex justify-end">
                                <button onclick="goToStep(2)" class="bg-indigo-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-indigo-700 transition-colors">Próximo</button>
                            </div>
                        </div>
                        
                        <!-- Step 2: Plataformas -->
                        <div id="step-2" class="step-content hidden">
                            <div class="space-y-6">
                                <div class="p-4 bg-yellow-50 rounded-xl border border-yellow-200">
                                    <h4 class="font-semibold text-gray-900 mb-2 flex items-center">
                                        <div class="w-6 h-6 bg-yellow-400 rounded-md flex items-center justify-center mr-2">
                                            <span class="text-white font-bold text-xs">ML</span>
                                        </div>
                                        Mercado Livre
                                    </h4>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">ID no Mercado Livre</label>
                                            <input type="text" id="product-ml-id" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                        </div>
                                        <div class="flex items-center">
                                            <input type="checkbox" id="sync-to-ml" class="mr-2">
                                            <label for="sync-to-ml" class="text-sm text-gray-700">Sincronizar com Mercado Livre</label>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="p-4 bg-blue-50 rounded-xl border border-blue-200">
                                    <h4 class="font-semibold text-gray-900 mb-2 flex items-center">
                                        <div class="w-6 h-6 bg-blue-600 rounded-md flex items-center justify-center mr-2">
                                            <span class="text-white font-bold text-xs">B</span>
                                        </div>
                                        Bling ERP
                                    </h4>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">ID no Bling</label>
                                            <input type="text" id="product-bling-id" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                        </div>
                                        <div class="flex items-center">
                                            <input type="checkbox" id="sync-to-bling" class="mr-2">
                                            <label for="sync-to-bling" class="text-sm text-gray-700">Sincronizar com Bling</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-8 flex justify-between">
                                <button onclick="goToStep(1)" class="bg-gray-200 text-gray-800 px-6 py-2 rounded-lg font-semibold hover:bg-gray-300 transition-colors">Anterior</button>
                                <button onclick="goToStep(3)" class="bg-indigo-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-indigo-700 transition-colors">Próximo</button>
                            </div>
                        </div>
                        
                        <!-- Step 3: Revisão -->
                        <div id="step-3" class="step-content hidden">
                            <div class="space-y-6">
                                <div class="p-4 bg-gray-50 rounded-xl">
                                    <h4 class="font-semibold text-gray-900 mb-4">Resumo do Produto</h4>
                                    <div class="space-y-3">
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Nome:</span>
                                            <span class="text-gray-900 font-medium" id="review-name">-</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Preço:</span>
                                            <span class="text-gray-900 font-medium" id="review-price">-</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Status:</span>
                                            <span class="text-gray-900 font-medium" id="review-status">-</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">ID Mercado Livre:</span>
                                            <span class="text-gray-900 font-medium" id="review-ml-id">-</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">ID Bling:</span>
                                            <span class="text-gray-900 font-medium" id="review-bling-id">-</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4 bg-yellow-50 rounded-xl border border-yellow-200">
                                    <p class="text-sm text-yellow-800">Ao confirmar, o produto será adicionado ao sistema e sincronizado com as plataformas selecionadas.</p>
                                </div>
                            </div>
                            <div class="mt-8 flex justify-between">
                                <button onclick="goToStep(2)" class="bg-gray-200 text-gray-800 px-6 py-2 rounded-lg font-semibold hover:bg-gray-300 transition-colors">Anterior</button>
                                <button onclick="saveProduct()" class="bg-green-600 text-white px-6 py-2 rounded-lg font-semibold hover:bg-green-700 transition-colors">Confirmar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sync Page -->
        <div id="sync-page" class="page-content">
            <header class="bg-white border-b border-gray-100 sticky top-0 z-40">
                <div class="px-8 py-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Sincronização</h1>
                            <p class="text-gray-600 mt-1 font-medium">Controle manual da sincronização</p>
                        </div>
                        <button onclick="runSync()" class="bg-indigo-600 text-white px-6 py-3 rounded-xl font-semibold flex items-center space-x-2 hover:bg-indigo-700 transition-colors">
                            <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                            <span>Executar Sincronização</span>
                        </button>
                    </div>
                </div>
            </header>

            <main class="p-8">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="card-premium p-8 rounded-2xl">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">Status da Sincronização</h3>
                        <div id="sync-status" class="space-y-4">
                            <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
                                <span class="font-medium text-gray-900">Categorias</span>
                                <span class="text-green-600 font-semibold">✓ Sincronizadas</span>
                            </div>
                            <div class="flex items-center justify-between p-4 bg-gray-50 rounded-xl">
                                <span class="font-medium text-gray-900">Produtos</span>
                                <span class="text-green-600 font-semibold">✓ Sincronizados</span>
                            </div>
                        </div>
                    </div>

                    <div class="card-premium p-8 rounded-2xl">
                        <h3 class="text-xl font-bold text-gray-900 mb-6">Logs de Sincronização</h3>
                        <div id="sync-logs" class="space-y-3 max-h-96 overflow-y-auto">
                            <div class="text-sm text-gray-600">
                                <span class="text-green-600">✓</span> Sincronização iniciada
                            </div>
                            <div class="text-sm text-gray-600">
                                <span class="text-green-600">✓</span> Categorias processadas
                            </div>
                            <div class="text-sm text-gray-600">
                                <span class="text-green-600">✓</span> Produtos atualizados
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Integrations Page -->
        <div id="integrations-page" class="page-content">
            <header class="bg-white border-b border-gray-100 sticky top-0 z-40">
                <div class="px-8 py-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Integrações</h1>
                            <p class="text-gray-600 mt-1 font-medium">Status das conexões com plataformas</p>
                        </div>
                        <button onclick="checkIntegrations()" class="bg-indigo-600 text-white px-6 py-3 rounded-xl font-semibold flex items-center space-x-2 hover:bg-indigo-700 transition-colors">
                            <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                            <span>Verificar Status</span>
                        </button>
                    </div>
                </div>
            </header>

            <main class="p-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="card-premium p-8 rounded-2xl border-2 border-green-200 bg-green-50">
                        <div class="flex items-center justify-between mb-6">
                            <div class="w-16 h-16 bg-yellow-400 rounded-2xl flex items-center justify-center shadow-lg">
                                <span class="text-white font-bold text-lg">ML</span>
                            </div>
                            <span class="text-green-600 font-semibold bg-green-100 px-3 py-1 rounded-full">Conectado</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Mercado Livre</h3>
                        <p class="text-gray-600 mb-6">Sincronização automática de produtos e pedidos</p>
                        <div class="space-y-3 mb-6">
                            <div class="flex items-center text-sm text-gray-600">
                                <i data-lucide="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                Token válido
                            </div>
                            <div class="flex items-center text-sm text-gray-600">
                                <i data-lucide="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                API funcionando
                            </div>
                            <div class="flex items-center text-sm text-gray-600">
                                <i data-lucide="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                Produtos sincronizados
                            </div>
                        </div>
                    </div>

                    <div class="card-premium p-8 rounded-2xl border-2 border-green-200 bg-green-50">
                        <div class="flex items-center justify-between mb-6">
                            <div class="w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center shadow-lg">
                                <span class="text-white font-bold text-lg">B</span>
                            </div>
                            <span class="text-green-600 font-semibold bg-green-100 px-3 py-1 rounded-full">Conectado</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900 mb-2">Bling ERP</h3>
                        <p class="text-gray-600 mb-6">Gestão completa de estoque e financeiro</p>
                        <div class="space-y-3 mb-6">
                            <div class="flex items-center text-sm text-gray-600">
                                <i data-lucide="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                Token válido
                            </div>
                            <div class="flex items-center text-sm text-gray-600">
                                <i data-lucide="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                API funcionando
                            </div>
                            <div class="flex items-center text-sm text-gray-600">
                                <i data-lucide="check" class="w-4 h-4 text-green-500 mr-2"></i>
                                Categorias criadas
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Logs Page -->
        <div id="logs-page" class="page-content">
            <header class="bg-white border-b border-gray-100 sticky top-0 z-40">
                <div class="px-8 py-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <h1 class="text-3xl font-bold text-gray-900">Logs</h1>
                            <p class="text-gray-600 mt-1 font-medium">Histórico de operações e erros</p>
                        </div>
                        <button onclick="clearLogs()" class="bg-red-600 text-white px-6 py-3 rounded-xl font-semibold flex items-center space-x-2 hover:bg-red-700 transition-colors">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                            <span>Limpar Logs</span>
                        </button>
                    </div>
                </div>
            </header>

            <main class="p-8">
                <div class="card-premium rounded-2xl overflow-hidden">
                    <div class="px-8 py-6 border-b border-gray-100">
                        <h3 class="text-xl font-bold text-gray-900">Logs do Sistema</h3>
                    </div>
                    <div class="p-8">
                        <div id="system-logs" class="space-y-3 max-h-96 overflow-y-auto font-mono text-sm">
                            <div class="text-green-600">[INFO] Sistema iniciado com sucesso</div>
                            <div class="text-blue-600">[SYNC] Sincronização iniciada</div>
                            <div class="text-green-600">[SUCCESS] 3 produtos processados</div>
                            <div class="text-yellow-600">[WARNING] Alguns produtos com IDs fictícios</div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();
        
        // Page navigation
        document.addEventListener('DOMContentLoaded', function() {
            const sidebarItems = document.querySelectorAll('.sidebar-item');
            const pages = document.querySelectorAll('.page-content');
            
            sidebarItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Update active sidebar item
                    sidebarItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show corresponding page
                    const targetPage = this.getAttribute('data-page');
                    pages.forEach(page => page.classList.remove('active'));
                    document.getElementById(targetPage + '-page').classList.add('active');
                });
            });
            
            // Load initial data
            loadProducts();
            updateMetrics();
        });

        // Functions
        function runSync() {
            addLog('Sincronização iniciada...', 'info');
            
            // Fazer chamada para a API hospedada no Vercel
            fetch(`${API_BASE_URL}/api/sync`)
                .then(response => response.json())
                .then(data => {
                    addLog('Categorias sincronizadas com sucesso!', 'success');
                    addLog('Produtos sincronizados com sucesso!', 'success');
                    updateMetrics();
                })
                .catch(error => {
                    addLog(`Erro na sincronização: ${error.message}`, 'error');
                });
        }

        function addTestProducts() {
            addLog('Adicionando produtos de teste...', 'info');
            
            // Fazer chamada para a API hospedada no Vercel
            fetch(`${API_BASE_URL}/api/add-test-products`)
                .then(response => response.json())
                .then(data => {
                    addLog('Produtos de teste adicionados!', 'success');
                    loadProducts();
                    updateMetrics();
                })
                .catch(error => {
                    addLog(`Erro ao adicionar produtos: ${error.message}`, 'error');
                });
        }

        function checkIntegrations() {
            addLog('Verificando integrações...', 'info');
            
            // Fazer chamada para a API hospedada no Vercel
            // Para testes locais, usamos o arquivo JSON
            fetch(`./api/check-integrations.json`)
                .then(response => response.json())
                .then(data => {
                    addLog('Integrações ML e Bling funcionando corretamente!', 'success');
                })
                .catch(error => {
                    addLog(`Erro ao verificar integrações: ${error.message}`, 'error');
                });
        }

        // Variável global para armazenar os produtos carregados
        let allProducts = [];
        let currentProductId = null;
        let currentStep = 1;
        
        function loadProducts() {
            const productsList = document.getElementById('products-list');
            const noProductsMessage = document.getElementById('no-products');
            
            showSpinner();
            
            // Tentar buscar produtos da API local para testes
            fetch(`./api/products.json`)
                .then(response => response.json())
                .then(data => {
                    hideSpinner();
                    
                    // Usar os dados do arquivo JSON ou dados de fallback
                    allProducts = data || [
                        { title: 'iPhone 15 Pro Max', ml_id: 'TEST-001', bling_id: 'BLG-001', price: 8999.99, status: 'active' },
                        { title: 'MacBook Air M3', ml_id: 'TEST-002', bling_id: 'BLG-002', price: 12999.99, status: 'active' },
                        { title: 'iPad Pro 12.9"', ml_id: 'TEST-003', bling_id: 'BLG-003', price: 7499.99, status: 'active' }
                    ];

                    // Renderizar produtos iniciais
                    renderProducts(allProducts);
                    
                    // Configurar eventos de busca e filtro
                    setupSearchAndFilters();
                })
                .catch(error => {
                    hideSpinner();
                    console.error('Erro ao carregar produtos:', error);
                    showToast('Erro', 'Não foi possível carregar os produtos', 'error');
                    
                    // Fallback para produtos de demonstração em caso de erro
                    allProducts = [
                        { title: 'iPhone 15 Pro Max', ml_id: 'TEST-001', bling_id: 'BLG-001', price: 8999.99, status: 'active' },
                        { title: 'MacBook Air M3', ml_id: 'TEST-002', bling_id: 'BLG-002', price: 12999.99, status: 'active' },
                        { title: 'iPad Pro 12.9"', ml_id: 'TEST-003', bling_id: 'BLG-003', price: 7499.99, status: 'inactive' }
                    ];
                    
                    // Renderizar produtos de fallback
                    renderProducts(allProducts);
                    
                    // Configurar eventos de busca e filtro
                    setupSearchAndFilters();
                });
        }
        
        function renderProducts(products) {
            const productsList = document.getElementById('products-list');
            const noProductsMessage = document.getElementById('no-products');
            
            if (products.length === 0) {
                productsList.innerHTML = '';
                noProductsMessage.classList.remove('hidden');
                return;
            }
            
            noProductsMessage.classList.add('hidden');
            
            productsList.innerHTML = products.map(product => {
                // Formatar o preço como moeda brasileira
                const formattedPrice = new Intl.NumberFormat('pt-BR', { 
                    style: 'currency', 
                    currency: 'BRL' 
                }).format(product.price);
                
                // Determinar o status para exibição
                const statusText = product.status === 'active' ? 'Em Estoque' : 'Indisponível';
                const statusColor = product.status === 'active' ? 'green' : 'red';
                
                return `
                <div class="card-premium p-6 rounded-xl product-card" data-id="${product.ml_id || product.bling_id}">
                    <div class="w-full h-48 bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg mb-4 flex items-center justify-center">
                        <i data-lucide="smartphone" class="w-12 h-12 text-gray-400"></i>
                    </div>
                    <h4 class="font-semibold text-gray-900 mb-2">${product.title}</h4>
                    <p class="text-sm text-gray-500 mb-3">ID ML: ${product.ml_id || 'N/A'} | ID Bling: ${product.bling_id || 'N/A'}</p>
                    <div class="flex items-center justify-between mb-4">
                        <span class="text-lg font-bold text-gray-900">${formattedPrice}</span>
                        <span class="text-xs font-semibold text-${statusColor}-600 bg-${statusColor}-100 px-2 py-1 rounded-full">${statusText}</span>
                    </div>
                    <div class="flex justify-end">
                        <button class="text-indigo-600 hover:text-indigo-800 text-sm font-medium edit-product-btn" data-id="${product.ml_id || product.bling_id}">
                            <i data-lucide="edit" class="w-4 h-4 inline mr-1"></i> Editar
                        </button>
                    </div>
                </div>`;
            }).join('');
            
            // Atualizar ícones
            lucide.createIcons();
            
            // Adicionar eventos de clique nos cards de produtos
            setupProductCardEvents();
        }
        
        function setupSearchAndFilters() {
            const searchInput = document.getElementById('product-search');
            const statusFilter = document.getElementById('status-filter');
            const addProductBtn = document.getElementById('add-product-btn');
            const clearFiltersBtn = document.getElementById('clear-filters-btn');
            
            // Evento de busca
            searchInput.addEventListener('input', filterProducts);
            
            // Evento de filtro por status
            statusFilter.addEventListener('change', filterProducts);
            
            // Evento para abrir modal de novo produto
            addProductBtn.addEventListener('click', () => {
                openProductModal();
            });
            
            // Evento para limpar filtros
            if (clearFiltersBtn) {
                clearFiltersBtn.addEventListener('click', () => {
                    searchInput.value = '';
                    statusFilter.value = 'all';
                    filterProducts();
                });
            }
        }
        
        function filterProducts() {
            const searchInput = document.getElementById('product-search');
            const statusFilter = document.getElementById('status-filter');
            
            const searchTerm = searchInput.value.toLowerCase().trim();
            const statusValue = statusFilter.value;
            
            // Filtrar produtos
            const filteredProducts = allProducts.filter(product => {
                // Filtro de busca
                const matchesSearch = 
                    product.title.toLowerCase().includes(searchTerm) ||
                    (product.ml_id && product.ml_id.toLowerCase().includes(searchTerm)) ||
                    (product.bling_id && product.bling_id.toLowerCase().includes(searchTerm));
                
                // Filtro de status
                const matchesStatus = statusValue === 'all' || product.status === statusValue;
                
                return matchesSearch && matchesStatus;
            });
            
            // Renderizar produtos filtrados
            renderProducts(filteredProducts);
        }
        
        function setupProductCardEvents() {
            // Adicionar evento de clique nos cards de produtos
            document.querySelectorAll('.product-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    // Ignorar se o clique foi no botão de editar
                    if (e.target.closest('.edit-product-btn')) return;
                    
                    const productId = this.getAttribute('data-id');
                    openProductDetails(productId);
                });
            });
            
            // Adicionar evento de clique nos botões de editar
            document.querySelectorAll('.edit-product-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation(); // Evitar que o evento de clique do card seja acionado
                    const productId = this.getAttribute('data-id');
                    openProductModal(productId);
                });
            });
        }
        
        function openProductDetails(productId) {
            // Encontrar o produto pelo ID
            const product = allProducts.find(p => p.ml_id === productId || p.bling_id === productId);
            
            if (!product) return;
            
            // Formatar o preço como moeda brasileira
            const formattedPrice = new Intl.NumberFormat('pt-BR', { 
                style: 'currency', 
                currency: 'BRL' 
            }).format(product.price);
            
            // Determinar o status para exibição
            const statusText = product.status === 'active' ? 'Em Estoque' : 'Indisponível';
            
            // Mostrar detalhes em um toast ou modal simples
            showToast(
                product.title,
                `${formattedPrice} - ${statusText}\nML: ${product.ml_id || 'N/A'} | Bling: ${product.bling_id || 'N/A'}`,
                'info',
                5000
            );
        }
        
        // Funções para gerenciar o modal de produtos
        function openProductModal(productId = null) {
            // Resetar o modal
            resetProductModal();
            
            // Atualizar o título do modal
            const modalTitle = document.getElementById('modal-title');
            if (productId) {
                modalTitle.textContent = 'Editar Produto';
                currentProductId = productId;
                
                // Preencher o formulário com os dados do produto
                const product = allProducts.find(p => p.ml_id === productId || p.bling_id === productId);
                if (product) {
                    fillProductForm(product);
                }
            } else {
                modalTitle.textContent = 'Adicionar Novo Produto';
                currentProductId = null;
            }
            
            // Mostrar o modal
            document.getElementById('product-modal').classList.remove('hidden');
            
            // Atualizar a exibição dos steps
            updateStepDisplay();
        }
        
        function closeProductModal() {
            document.getElementById('product-modal').classList.add('hidden');
            resetProductModal();
        }
        
        function resetProductModal() {
            // Resetar o step atual
            currentStep = 1;
            
            // Limpar formulários
            document.getElementById('product-name').value = '';
            document.getElementById('product-description').value = '';
            document.getElementById('product-price').value = '';
            document.getElementById('product-status').value = 'active';
            
            // Esconder todos os steps exceto o primeiro
            document.querySelectorAll('.step-content').forEach(step => {
                step.classList.add('hidden');
            });
            document.getElementById('step-1').classList.remove('hidden');
            
            // Resetar indicadores de progresso
            updateStepDisplay();
        }
        
        function fillProductForm(product) {
            // Preencher os campos do formulário com os dados do produto
            document.getElementById('product-name').value = product.title || '';
            document.getElementById('product-description').value = product.description || '';
            document.getElementById('product-price').value = product.price || '';
            document.getElementById('product-status').value = product.status || 'active';
        }
        
        function goToStep(step) {
            // Validar o step atual antes de avançar
            if (step > currentStep && !validateCurrentStep()) {
                return;
            }
            
            // Esconder o step atual
            document.getElementById(`step-${currentStep}`).classList.add('hidden');
            
            // Atualizar o step atual
            currentStep = step;
            
            // Mostrar o novo step
            document.getElementById(`step-${currentStep}`).classList.remove('hidden');
            
            // Se estiver indo para o step de revisão, atualizar o resumo
            if (step === 3) {
                updateProductReview();
            }
            
            // Atualizar a exibição dos steps
            updateStepDisplay();
        }
        
        function updateProductReview() {
            // Obter valores dos campos
            const name = document.getElementById('product-name').value.trim();
            const price = parseFloat(document.getElementById('product-price').value.trim());
            const status = document.getElementById('product-status').value;
            const mlId = document.getElementById('product-ml-id')?.value.trim() || '-';
            const blingId = document.getElementById('product-bling-id')?.value.trim() || '-';
            
            // Formatar o preço como moeda brasileira
            const formattedPrice = new Intl.NumberFormat('pt-BR', { 
                style: 'currency', 
                currency: 'BRL' 
            }).format(price || 0);
            
            // Determinar o texto do status
            const statusText = status === 'active' ? 'Em Estoque' : 'Indisponível';
            
            // Atualizar os elementos de revisão
            document.getElementById('review-name').textContent = name || '-';
            document.getElementById('review-price').textContent = formattedPrice;
            document.getElementById('review-status').textContent = statusText;
            document.getElementById('review-ml-id').textContent = mlId;
            document.getElementById('review-bling-id').textContent = blingId;
        }
        
        function validateCurrentStep() {
            // Validar os campos do step atual
            switch (currentStep) {
                case 1:
                    // Validar informações básicas
                    const name = document.getElementById('product-name').value.trim();
                    const price = document.getElementById('product-price').value.trim();
                    
                    if (!name) {
                        showToast('Erro', 'O nome do produto é obrigatório', 'error');
                        return false;
                    }
                    
                    if (!price || isNaN(parseFloat(price))) {
                        showToast('Erro', 'O preço do produto é obrigatório e deve ser um número válido', 'error');
                        return false;
                    }
                    
                    return true;
                    
                case 2:
                    // Validação opcional para o step 2
                    return true;
                    
                case 3:
                    // Validação opcional para o step 3
                    return true;
                    
                default:
                    return true;
            }
        }
        
        function updateStepDisplay() {
            // Atualizar a barra de progresso
            const progress = document.getElementById('steps-progress');
            progress.style.width = `${((currentStep - 1) / 2) * 100}%`;
            
            // Atualizar os indicadores de step
            document.querySelectorAll('.step-indicator').forEach((indicator) => {
                const step = parseInt(indicator.getAttribute('data-step'));
                const stepCircle = indicator.querySelector('div');
                const stepText = indicator.querySelector('span');
                
                // Remover todas as classes de estado
                indicator.classList.remove('active');
                
                if (step < currentStep) {
                    // Step concluído
                    indicator.classList.add('active');
                    stepCircle.className = 'w-10 h-10 rounded-full bg-gradient-to-br from-green-500 to-green-700 text-white flex items-center justify-center font-semibold text-sm shadow-md transform transition-all duration-300 border-2 border-white';
                    stepText.className = 'text-xs font-medium mt-2 block text-center text-green-700';
                    
                    // Substituir o ícone por um check para steps concluídos
                    stepCircle.innerHTML = '<i data-lucide="check" class="w-5 h-5"></i>';
                } else if (step === currentStep) {
                    // Step atual
                    indicator.classList.add('active');
                    stepCircle.className = 'w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-indigo-700 text-white flex items-center justify-center font-semibold text-sm shadow-md transform scale-110 transition-all duration-300 border-2 border-white';
                    stepText.className = 'text-xs font-medium mt-2 block text-center text-indigo-700';
                    
                    // Manter o ícone original para o step atual
                    if (step === 1) {
                        stepCircle.innerHTML = '<i data-lucide="clipboard-list" class="w-5 h-5"></i>';
                    } else if (step === 2) {
                        stepCircle.innerHTML = '<i data-lucide="layers" class="w-5 h-5"></i>';
                    } else if (step === 3) {
                        stepCircle.innerHTML = '<i data-lucide="check-circle" class="w-5 h-5"></i>';
                    }
                } else {
                    // Step futuro
                    stepCircle.className = 'w-10 h-10 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-semibold text-sm shadow-sm transition-all duration-300 border-2 border-white';
                    stepText.className = 'text-xs font-medium mt-2 block text-center text-gray-500';
                    
                    // Manter o ícone original para steps futuros
                    if (step === 1) {
                        stepCircle.innerHTML = '<i data-lucide="clipboard-list" class="w-5 h-5"></i>';
                    } else if (step === 2) {
                        stepCircle.innerHTML = '<i data-lucide="layers" class="w-5 h-5"></i>';
                    } else if (step === 3) {
                        stepCircle.innerHTML = '<i data-lucide="check-circle" class="w-5 h-5"></i>';
                    }
                }
            });
            
            // Atualizar ícones
            lucide.createIcons();
        }
        
        function saveProduct() {
            // Validar o último step antes de salvar
            if (!validateCurrentStep()) {
                return;
            }
            
            // Coletar dados do formulário
            const productData = {
                title: document.getElementById('product-name').value.trim(),
                description: document.getElementById('product-description').value.trim(),
                price: parseFloat(document.getElementById('product-price').value.trim()),
                status: document.getElementById('product-status').value
            };
            
            // Mostrar spinner durante o processamento
            showSpinner();
            
            // Simular uma chamada de API para salvar o produto
            setTimeout(() => {
                hideSpinner();
                
                if (currentProductId) {
                    // Atualizar produto existente
                    const index = allProducts.findIndex(p => p.ml_id === currentProductId || p.bling_id === currentProductId);
                    
                    if (index !== -1) {
                        allProducts[index] = { ...allProducts[index], ...productData };
                        showToast('Sucesso', 'Produto atualizado com sucesso!', 'success');
                    } else {
                        showToast('Erro', 'Produto não encontrado para atualização', 'error');
                    }
                } else {
                    // Adicionar novo produto
                    const newProduct = {
                        ...productData,
                        ml_id: `ML-${Math.floor(Math.random() * 10000)}`,
                        bling_id: `BLG-${Math.floor(Math.random() * 10000)}`
                    };
                    
                    allProducts.push(newProduct);
                    showToast('Sucesso', 'Produto adicionado com sucesso!', 'success');
                }
                
                // Fechar o modal
                closeProductModal();
                
                // Renderizar produtos atualizados
                renderProducts(allProducts);
            }, 1000);
        }

        function updateMetrics() {
            // Buscar métricas da API local para testes
            fetch(`./api/metrics.json`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('products-count').textContent = data.productsCount || '3';
                    document.getElementById('pending-count').textContent = data.pendingCount || '0';
                    document.getElementById('last-sync').textContent = data.lastSync || 'Agora';
                    document.getElementById('sync-count').textContent = data.syncCount || '856';
                })
                .catch(error => {
                    console.error('Erro ao carregar métricas:', error);
                    // Valores padrão em caso de erro
                    document.getElementById('products-count').textContent = '3';
                    document.getElementById('pending-count').textContent = '0';
                    document.getElementById('last-sync').textContent = 'Agora';
                });
        }

        function addLog(message, type = 'info') {
            const activityLog = document.getElementById('activity-log');
            const systemLogs = document.getElementById('system-logs');
            
            const timestamp = new Date().toLocaleTimeString();
            const icon = type === 'success' ? 'check' : type === 'error' ? 'x' : 'info';
            const color = type === 'success' ? 'green' : type === 'error' ? 'red' : 'blue';
            
            // Add to activity log
            activityLog.insertAdjacentHTML('afterbegin', `
                <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-xl">
                    <div class="w-10 h-10 bg-${color}-100 rounded-full flex items-center justify-center">
                        <i data-lucide="${icon}" class="w-5 h-5 text-${color}-600"></i>
                    </div>
                    <div class="flex-1">
                        <p class="font-medium text-gray-900">${message}</p>
                        <p class="text-sm text-gray-500">Operação realizada com sucesso</p>
                    </div>
                    <span class="text-sm text-gray-400">Agora</span>
                </div>
            `);
            
            // Add to system logs
            systemLogs.insertAdjacentHTML('afterbegin', `
                <div class="text-${color}-600">[${type.toUpperCase()}] ${message} - ${timestamp}</div>
            `);
            
            lucide.createIcons();
        }

        function clearLogs() {
            document.getElementById('system-logs').innerHTML = '';
            addLog('Logs limpos com sucesso', 'success');
        }

        // Funções para controlar o spinner de carregamento
        function showSpinner() {
            document.getElementById('loading-spinner').classList.remove('hidden');
        }

        function hideSpinner() {
            document.getElementById('loading-spinner').classList.add('hidden');
        }
        
        // Funções para controlar o toast de notificação
        function showToast(title, message, type = 'success', duration = 3000) {
            // Configurar o toast
            const toast = document.getElementById('toast');
            const toastContainer = document.getElementById('toast-container');
            const toastTitle = document.getElementById('toast-title');
            const toastMessage = document.getElementById('toast-message');
            const toastIcon = document.getElementById('toast-icon');
            const toastIconSvg = document.getElementById('toast-icon-svg');
            const toastProgress = document.getElementById('toast-progress');
            
            // Definir conteúdo
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            
            // Configurar tipo (success, error, warning, info)
            let iconName = 'check';
            let bgColor = 'bg-green-100';
            let textColor = 'text-green-600';
            let progressColor = 'bg-green-600';
            
            if (type === 'error') {
                iconName = 'x';
                bgColor = 'bg-red-100';
                textColor = 'text-red-600';
                progressColor = 'bg-red-600';
            } else if (type === 'warning') {
                iconName = 'alert-triangle';
                bgColor = 'bg-yellow-100';
                textColor = 'text-yellow-600';
                progressColor = 'bg-yellow-600';
            } else if (type === 'info') {
                iconName = 'info';
                bgColor = 'bg-blue-100';
                textColor = 'text-blue-600';
                progressColor = 'bg-blue-600';
            }
            
            // Aplicar estilos
            toastIconSvg.setAttribute('data-lucide', iconName);
            toastIcon.className = `flex-shrink-0 w-8 h-8 ${bgColor} rounded-full flex items-center justify-center mr-3`;
            toastIconSvg.className = `w-5 h-5 ${textColor}`;
            toastProgress.className = `h-1 ${progressColor} w-full transform origin-left scale-x-0 transition-transform duration-300`;
            
            // Atualizar ícones
            lucide.createIcons();
            
            // Mostrar o toast
            toastContainer.classList.remove('hidden');
            
            // Animar entrada
            setTimeout(() => {
                toast.classList.remove('opacity-0', 'translate-y-4');
                toast.classList.add('opacity-100', 'translate-y-0');
                
                // Animar barra de progresso
                toastProgress.classList.add('scale-x-100');
            }, 10);
            
            // Esconder após duração
            if (duration > 0) {
                toastTimeout = setTimeout(() => {
                    hideToast();
                }, duration);
            }
        }
        
        let toastTimeout;
        
        function hideToast() {
            const toast = document.getElementById('toast');
            const toastContainer = document.getElementById('toast-container');
            const toastProgress = document.getElementById('toast-progress');
            
            // Limpar timeout se existir
            if (toastTimeout) {
                clearTimeout(toastTimeout);
            }
            
            // Animar saída
            toast.classList.add('opacity-0', 'translate-y-4');
            toast.classList.remove('opacity-100', 'translate-y-0');
            toastProgress.classList.remove('scale-x-100');
            
            // Esconder após animação
            setTimeout(() => {
                toastContainer.classList.add('hidden');
            }, 300);
        }

        // Modificando as funções existentes para usar o spinner, toast e SSE
        const originalRunSync = runSync;
        runSync = function() {
            showSpinner();
            showToast('Sincronização', 'Iniciando sincronização de produtos...', 'info');
            addLog('Sincronização iniciada...', 'info');
            
            // Criar elemento de progresso na página de sincronização
            const syncPage = document.getElementById('sync-page');
            const progressContainer = document.createElement('div');
            progressContainer.id = 'sync-progress-container';
            progressContainer.className = 'card-premium p-8 rounded-2xl mt-8';
            progressContainer.innerHTML = `
                <div class="mb-4 flex items-center justify-between">
                    <h3 class="text-xl font-bold text-gray-900">Progresso da Sincronização</h3>
                    <span id="sync-progress-percentage" class="text-blue-600 font-semibold">0%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-4 mb-6">
                    <div id="sync-progress-bar" class="bg-blue-600 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div id="sync-progress-details" class="space-y-3">
                    <div class="text-gray-600">Aguardando início da sincronização...</div>
                </div>
            `;
            
            // Verificar se o container já existe e remover se necessário
            const existingContainer = document.getElementById('sync-progress-container');
            if (existingContainer) {
                existingContainer.remove();
            }
            
            // Adicionar o container à página
            const syncPageMain = syncPage.querySelector('main');
            syncPageMain.appendChild(progressContainer);
            
            // Simular SSE para demonstração (em produção, usaria um endpoint real de SSE)
            // Em um ambiente real, usaríamos: const eventSource = new EventSource(`${API_BASE_URL}/api/sync-progress`);
            simulateSyncProgress();
            
            // Fazer chamada para a API hospedada no Vercel
            fetch(`${API_BASE_URL}/api/sync`)
                .then(response => response.json())
                .then(data => {
                    // A sincronização real terminou, mas vamos deixar a simulação de progresso terminar
                    // O código abaixo será executado pela simulação quando chegar a 100%
                })
                .catch(error => {
                    hideSpinner();
                    showToast('Erro', `Falha na sincronização: ${error.message}`, 'error');
                    addLog(`Erro na sincronização: ${error.message}`, 'error');
                    stopSyncProgressSimulation();
                });
        };
        
        // Variáveis para controlar a simulação de progresso
        let syncProgressInterval;
        let currentProgress = 0;
        const syncSteps = [
            { progress: 5, message: 'Conectando com Mercado Livre...' },
            { progress: 10, message: 'Conexão estabelecida com Mercado Livre' },
            { progress: 15, message: 'Conectando com Bling ERP...' },
            { progress: 20, message: 'Conexão estabelecida com Bling ERP' },
            { progress: 25, message: 'Buscando categorias do Mercado Livre...' },
            { progress: 35, message: 'Sincronizando categorias com Bling...' },
            { progress: 45, message: 'Categorias sincronizadas com sucesso' },
            { progress: 50, message: 'Buscando produtos do Bling ERP...' },
            { progress: 65, message: 'Processando 24 produtos...' },
            { progress: 75, message: 'Atualizando estoque no Mercado Livre...' },
            { progress: 85, message: 'Atualizando preços no Mercado Livre...' },
            { progress: 95, message: 'Finalizando sincronização...' },
            { progress: 100, message: 'Sincronização concluída com sucesso!' }
        ];
        
        function simulateSyncProgress() {
            currentProgress = 0;
            let stepIndex = 0;
            
            // Atualizar progresso inicial
            updateSyncProgress(0, 'Iniciando sincronização...');
            
            // Limpar intervalo anterior se existir
            if (syncProgressInterval) {
                clearInterval(syncProgressInterval);
            }
            
            // Criar novo intervalo para simular progresso
            syncProgressInterval = setInterval(() => {
                if (stepIndex < syncSteps.length) {
                    const step = syncSteps[stepIndex];
                    updateSyncProgress(step.progress, step.message);
                    stepIndex++;
                    
                    // Se chegou a 100%, finalizar
                    if (step.progress === 100) {
                        finalizeSyncProgress();
                    }
                } else {
                    finalizeSyncProgress();
                }
            }, 1000); // Atualizar a cada segundo
        }
        
        function updateSyncProgress(progress, message) {
            currentProgress = progress;
            
            // Atualizar barra de progresso
            const progressBar = document.getElementById('sync-progress-bar');
            const progressPercentage = document.getElementById('sync-progress-percentage');
            const progressDetails = document.getElementById('sync-progress-details');
            
            if (progressBar && progressPercentage && progressDetails) {
                progressBar.style.width = `${progress}%`;
                progressPercentage.textContent = `${progress}%`;
                
                // Adicionar mensagem ao log de progresso
                const timestamp = new Date().toLocaleTimeString();
                progressDetails.insertAdjacentHTML('afterbegin', `
                    <div class="flex items-center text-sm">
                        <span class="text-gray-500 mr-2">[${timestamp}]</span>
                        <span class="text-gray-800">${message}</span>
                    </div>
                `);
                
                // Limitar o número de mensagens para evitar sobrecarga
                const messages = progressDetails.querySelectorAll('div');
                if (messages.length > 10) {
                    messages[messages.length - 1].remove();
                }
            }
            
            // Adicionar ao log do sistema
            addLog(message, progress === 100 ? 'success' : 'info');
        }
        
        function finalizeSyncProgress() {
            // Limpar intervalo
            stopSyncProgressSimulation();
            
            // Esconder spinner e mostrar toast de sucesso
            hideSpinner();
            showToast('Sucesso', 'Sincronização concluída com sucesso!', 'success');
            
            // Atualizar métricas
            updateMetrics();
        }
        
        function stopSyncProgressSimulation() {
            if (syncProgressInterval) {
                clearInterval(syncProgressInterval);
                syncProgressInterval = null;
            }
        }

        const originalAddTestProducts = addTestProducts;
        addTestProducts = function() {
            showSpinner();
            showToast('Produtos', 'Adicionando produtos de teste...', 'info');
            addLog('Adicionando produtos de teste...', 'info');
            
            // Fazer chamada para a API hospedada no Vercel
            fetch(`${API_BASE_URL}/api/add-test-products`)
                .then(response => response.json())
                .then(data => {
                    hideSpinner();
                    showToast('Sucesso', 'Produtos de teste adicionados com sucesso!', 'success');
                    addLog('Produtos de teste adicionados!', 'success');
                    loadProducts();
                    updateMetrics();
                })
                .catch(error => {
                    hideSpinner();
                    showToast('Erro', `Falha ao adicionar produtos: ${error.message}`, 'error');
                    addLog(`Erro ao adicionar produtos: ${error.message}`, 'error');
                });
        };

        const originalCheckIntegrations = checkIntegrations;
        checkIntegrations = function() {
            showSpinner();
            showToast('Integrações', 'Verificando status das integrações...', 'info');
            addLog('Verificando integrações...', 'info');
            
            // Fazer chamada para a API hospedada no Vercel
            fetch(`${API_BASE_URL}/api/check-integrations`)
                .then(response => response.json())
                .then(data => {
                    hideSpinner();
                    
                    // Verificar se temos dados reais das integrações
                    if (data && (data.ml || data.bling)) {
                        // Atualizar a interface com os dados reais
                        updateIntegrationsUI(data);
                        
                        // Verificar status das integrações
                        const mlValid = data.ml && data.ml.valid;
                        const blingValid = data.bling && data.bling.valid;
                        
                        if (mlValid && blingValid) {
                            showToast('Sucesso', 'Todas as integrações estão funcionando corretamente!', 'success');
                            addLog('Integrações ML e Bling funcionando corretamente!', 'success');
                        } else if (!mlValid && !blingValid) {
                            showToast('Erro', 'Ambas integrações estão com problemas!', 'error');
                            addLog('Ambas integrações estão com problemas!', 'error');
                        } else {
                            showToast('Alerta', 'Algumas integrações apresentam problemas!', 'warning');
                            addLog(`Status das integrações: ML (${mlValid ? 'OK' : 'Erro'}), Bling (${blingValid ? 'OK' : 'Erro'})`, 'warning');
                        }
                    } else {
                        showToast('Sucesso', 'Integrações verificadas com sucesso!', 'success');
                        addLog('Integrações ML e Bling funcionando corretamente!', 'success');
                    }
                })
                .catch(error => {
                    hideSpinner();
                    showToast('Erro', `Falha ao verificar integrações: ${error.message}`, 'error');
                    addLog(`Erro ao verificar integrações: ${error.message}`, 'error');
                });
        };
        
        // Função para atualizar a UI com os dados das integrações
        function updateIntegrationsUI(data) {
            // Atualizar a seção de integrações no dashboard
            const dashboardIntegrationsSection = document.querySelector('#dashboard-page .card-premium:nth-child(4)');
            if (dashboardIntegrationsSection) {
                const mlStatus = data.ml && data.ml.valid;
                const blingStatus = data.bling && data.bling.valid;
                
                // Atualizar o conteúdo da seção
                const integrationsContent = dashboardIntegrationsSection.querySelector('.space-y-6');
                if (integrationsContent) {
                    integrationsContent.innerHTML = `
                        <div class="flex items-center justify-between p-4 ${mlStatus ? 'bg-green-50' : 'bg-red-50'} rounded-xl border ${mlStatus ? 'border-green-200' : 'border-red-200'}">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-yellow-400 rounded-lg flex items-center justify-center">
                                    <span class="text-white font-bold text-xs">ML</span>
                                </div>
                                <div>
                                    <span class="font-medium text-gray-900">Mercado Livre</span>
                                    <p class="text-sm text-gray-600">${mlStatus ? 'Token válido' : 'Token inválido'}</p>
                                </div>
                            </div>
                            <span class="${mlStatus ? 'text-green-600' : 'text-red-600'} font-semibold">${mlStatus ? '✓ Conectado' : '✗ Desconectado'}</span>
                        </div>
                        <div class="flex items-center justify-between p-4 ${blingStatus ? 'bg-green-50' : 'bg-red-50'} rounded-xl border ${blingStatus ? 'border-green-200' : 'border-red-200'}">
                            <div class="flex items-center space-x-3">
                                <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                                    <span class="text-white font-bold text-xs">B</span>
                                </div>
                                <div>
                                    <span class="font-medium text-gray-900">Bling ERP</span>
                                    <p class="text-sm text-gray-600">${blingStatus ? 'Token válido' : 'Token inválido'}</p>
                                </div>
                            </div>
                            <span class="${blingStatus ? 'text-green-600' : 'text-red-600'} font-semibold">${blingStatus ? '✓ Conectado' : '✗ Desconectado'}</span>
                        </div>
                    `;
                }
            }
            
            // Atualizar a página de integrações
            const integrationsPage = document.getElementById('integrations-page');
            if (integrationsPage) {
                const mlCard = integrationsPage.querySelector('.card-premium:nth-child(1)');
                const blingCard = integrationsPage.querySelector('.card-premium:nth-child(2)');
                
                if (mlCard && data.ml) {
                    const mlStatus = data.ml.valid;
                    mlCard.className = `card-premium p-8 rounded-2xl border-2 ${mlStatus ? 'border-green-200 bg-green-50' : 'border-red-200 bg-red-50'}`;
                    
                    // Atualizar detalhes da integração ML
                    const mlDetails = mlCard.querySelector('.mt-6');
                    if (mlDetails) {
                        mlDetails.innerHTML = `
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Status:</span>
                                    <span class="${mlStatus ? 'text-green-600' : 'text-red-600'} font-medium">${mlStatus ? 'Ativo' : 'Inativo'}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">API:</span>
                                    <span class="${data.ml.apiWorking ? 'text-green-600' : 'text-red-600'} font-medium">${data.ml.apiWorking ? 'Funcionando' : 'Com problemas'}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Produtos:</span>
                                    <span class="${data.ml.productsSynced ? 'text-green-600' : 'text-yellow-600'} font-medium">${data.ml.productsSynced ? 'Sincronizados' : 'Pendentes'}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Expira em:</span>
                                    <span class="text-gray-800 font-medium">${new Date(data.ml.expiresAt).toLocaleDateString()}</span>
                                </div>
                            </div>
                        `;
                    }
                }
                
                if (blingCard && data.bling) {
                    const blingStatus = data.bling.valid;
                    blingCard.className = `card-premium p-8 rounded-2xl border-2 ${blingStatus ? 'border-green-200 bg-green-50' : 'border-red-200 bg-red-50'}`;
                    
                    // Atualizar detalhes da integração Bling
                    const blingDetails = blingCard.querySelector('.mt-6');
                    if (blingDetails) {
                        blingDetails.innerHTML = `
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Status:</span>
                                    <span class="${blingStatus ? 'text-green-600' : 'text-red-600'} font-medium">${blingStatus ? 'Ativo' : 'Inativo'}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">API:</span>
                                    <span class="${data.bling.apiWorking ? 'text-green-600' : 'text-red-600'} font-medium">${data.bling.apiWorking ? 'Funcionando' : 'Com problemas'}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Categorias:</span>
                                    <span class="${data.bling.categoriesCreated ? 'text-green-600' : 'text-yellow-600'} font-medium">${data.bling.categoriesCreated ? 'Criadas' : 'Pendentes'}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">Expira em:</span>
                                    <span class="text-gray-800 font-medium">${new Date(data.bling.expiresAt).toLocaleDateString()}</span>
                                </div>
                            </div>
                        `;
                    }
                }
            }
        }
        
        // Modificar a função addLog para usar toast em casos de erro
        const originalAddLog = addLog;
        addLog = function(message, type = 'info') {
            originalAddLog(message, type);
            
            // Mostrar toast para erros
            if (type === 'error') {
                showToast('Erro', message, 'error');
            }
        };
        
        // Função para testar os componentes de UI
        function testComponents() {
            // Testar spinner
            showSpinner();
            showToast('Teste', 'Testando o spinner...', 'info');
            
            // Esconder spinner após 2 segundos
            setTimeout(() => {
                hideSpinner();
                showToast('Sucesso', 'Spinner testado com sucesso!', 'success');
                
                // Testar toast de erro após 2 segundos
                setTimeout(() => {
                    showToast('Erro', 'Este é um exemplo de mensagem de erro', 'error', 3000);
                    
                    // Testar toast de aviso após 2 segundos
                    setTimeout(() => {
                        showToast('Aviso', 'Este é um exemplo de mensagem de aviso', 'warning', 3000);
                    }, 2000);
                }, 2000);
            }, 2000);
        }
        
        // Adicionar botão de teste no header do dashboard
        document.addEventListener('DOMContentLoaded', function() {
            const dashboardHeader = document.querySelector('#dashboard-page header .flex.items-center.justify-between');
            if (dashboardHeader) {
                const testButton = document.createElement('button');
                testButton.className = 'bg-purple-600 text-white px-4 py-2 rounded-xl font-semibold flex items-center space-x-2 hover:bg-purple-700 transition-colors mr-4';
                testButton.innerHTML = '<i data-lucide="zap" class="w-4 h-4 mr-2"></i> Testar UI';
                testButton.onclick = testComponents;
                
                // Inserir no início do header
                const syncButton = dashboardHeader.querySelector('button');
                if (syncButton && syncButton.parentNode === dashboardHeader) {
                    // Se o botão de sincronização existir e for filho direto do header, inserir antes dele
                    dashboardHeader.insertBefore(testButton, syncButton);
                } else {
                    // Caso contrário, apenas adicionar ao final do header
                    dashboardHeader.appendChild(testButton);
                }
                
                // Atualizar ícones
                lucide.createIcons();
            }
        });
    </script>
</body>
</html>
